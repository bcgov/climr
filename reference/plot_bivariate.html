<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to
show differences in climate change trends among global climate models (GCMs),
show the differences between multiple simulations of each model, and
compare simulated climate change to observed climate change in the 2001-2020 period.
All climate changes are relative to the 1961-1990 reference period normals."><title>Bivariate climate change plots — plot_bivariate • climr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bivariate climate change plots — plot_bivariate"><meta property="og:description" content="Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to
show differences in climate change trends among global climate models (GCMs),
show the differences between multiple simulations of each model, and
compare simulated climate change to observed climate change in the 2001-2020 period.
All climate changes are relative to the 1961-1990 reference period normals."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">climr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/caching.html">caching</a>
    <a class="dropdown-item" href="../articles/climr_with_rasters.html">Working with rasters and other spatial objects</a>
    <a class="dropdown-item" href="../articles/climr_workflow_beg.html">`climr` workflow - beginner</a>
    <a class="dropdown-item" href="../articles/climr_workflow_int.html">`climr` workflow - intermediate</a>
    <a class="dropdown-item" href="../articles/lapse_rates.html">Lapse rates</a>
    <a class="dropdown-item" href="../articles/methods_downscaling.html">`climr` downscaling methods</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bivariate climate change plots</h1>
      
      <div class="d-none name"><code>plot_bivariate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to</p><ol><li><p>show differences in climate change trends among global climate models (GCMs),</p></li>
<li><p>show the differences between multiple simulations of each model, and</p></li>
<li><p>compare simulated climate change to observed climate change in the 2001-2020 period.</p></li>
</ol><p>All climate changes are relative to the 1961-1990 reference period normals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_bivariate</span><span class="op">(</span></span>
<span>  <span class="va">xyz</span>,</span>
<span>  xvar <span class="op">=</span> <span class="st">"Tave_sm"</span>,</span>
<span>  yvar <span class="op">=</span> <span class="st">"PPT_sm"</span>,</span>
<span>  period_focal <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcm_period</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  gcm_models <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcm</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  ssp <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_ssp</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  historic_period <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_historic</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  gcm_period <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcm_period</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_run <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  legend_pos <span class="op">=</span> <span class="st">"bottomleft"</span>,</span>
<span>  show_runs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_ensMean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_observed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_trajectories <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>xyz</dt>
<dd><p>a <code>data.frame</code> with the following columns "long", "lat", "elev",
and a unique "id". Any extra columns will be ignored and not output.</p></dd>


<dt>xvar</dt>
<dd><p>character. x-axis variable. options are <code><a href="data-option-lists.html">list_variables()</a></code>.</p></dd>


<dt>yvar</dt>
<dd><p>character. y-axis variable. options are <code><a href="data-option-lists.html">list_variables()</a></code>.</p></dd>


<dt>period_focal</dt>
<dd><p>character. The 20-year period for which to plot the ensemble detail. options are <code><a href="data-option-lists.html">list_gcm_period()</a></code>.</p></dd>


<dt>gcm_models</dt>
<dd><p>character. Vector of GCM names. Options are <code><a href="data-option-lists.html">list_gcm()</a></code>. Used for gcm periods, gcm timeseries, and historic timeseries. Default <code>NULL</code></p></dd>


<dt>ssp</dt>
<dd><p>character. Vector of labels of the shared socioeconomic pathways to use.
See available options with <code><a href="data-option-lists.html">list_ssp()</a></code>. Defaults to all SSPs available.</p></dd>


<dt>historic_period</dt>
<dd><p>character. Which historic period. Default <code>NULL</code></p></dd>


<dt>gcm_period</dt>
<dd><p>character. Requested future periods. Options are <code><a href="data-option-lists.html">list_gcm_period()</a></code></p></dd>


<dt>max_run</dt>
<dd><p>integer. Maximum number of model runs to include.
A value of 0 returns the <code>ensembleMean</code> only. Runs are included in the order they
are found in the models data until <code>max_run</code> is reached. Defaults to 0L.</p></dd>


<dt>legend_pos</dt>
<dd><p>character. Position of the legend. Options are <code>c("bottomright", "bottom", "bottomleft", "left", "topleft", "top", "topright", "right", "center")</code>.</p></dd>


<dt>show_runs</dt>
<dd><p>logical. If TRUE, the individual runs of the model are plotted (for <code>period_focal</code> only) in addition to the single-model ensemble mean.</p></dd>


<dt>show_ensMean</dt>
<dd><p>logical. If TRUE, the multi-model ensemble mean is plotted (for <code>period_focal</code> only).</p></dd>


<dt>show_observed</dt>
<dd><p>logical. If TRUE, the 2001-2020 observed climate is plotted.</p></dd>


<dt>show_trajectories</dt>
<dd><p>logical. If TRUE, the values of the single-model ensemble mean are plotted for all 20-year periods in <code><a href="data-option-lists.html">list_gcm_period()</a></code>, connected by an interpolation spline.</p></dd>


<dt>interactive</dt>
<dd><p>logical. If TRUE, an interactive plot is generated using <code>{plotly}</code>. If FALSE, a plot is generated using base graphics.</p></dd>


<dt>cache</dt>
<dd><p>logical. Cache data locally? Default <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>NULL. Draws a plot in the active graphics device.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input table <code>xyz</code> can be a single location or multiple locations. If multiple locations, the plot provides the mean of the anomalies for these locations.
The climate change trajectories provided by <code>show_trajectories</code> are points for each of the five 20-year periods specified by <code><a href="data-option-lists.html">list_gcm_period()</a></code>. These points are connected with an interpolation spline when the x variable is monotonic; otherwise the trajectory points are connected by straight lines.
This plot is designed to be used with a single SSP scenario. If multiple scenarios are passed to the plot, the GCM means and ensemble mean are averaged across the scenarios, but the individual runs for all scenarios are plotted separately.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># data frame of arbitrary points on Vancouver Island</span></span></span>
<span class="r-in"><span><span class="va">my_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">123.4404</span>, <span class="op">-</span><span class="fl">123.5064</span>, <span class="op">-</span><span class="fl">124.2317</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">48.52631</span>, <span class="fl">48.46807</span>, <span class="fl">49.21999</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        elev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">103</span>, <span class="fl">357</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        id <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw the plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_bivariate</span><span class="op">(</span><span class="va">my_points</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: stinepack</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to climr!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting normals...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> for BC...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Not fully cached :( Will download more</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading new data...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting historic...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting GCMs...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Not fully cached :( Will download more</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading GCM anomalies</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Caching data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downscaling!!</span>
<span class="r-plt img"><img src="plot_bivariate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># export plot to the working directory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">"plot_test.png"</span>, type<span class="op">=</span><span class="st">"cairo"</span>, units<span class="op">=</span><span class="st">"in"</span>, width<span class="op">=</span><span class="fl">6</span>, height<span class="op">=</span><span class="fl">5</span>, pointsize<span class="op">=</span><span class="fl">10</span>, res<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_bivariate</span><span class="op">(</span><span class="va">my_points</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to climr!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting normals...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> for BC...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting historic...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting GCMs...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Retrieving from cache...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downscaling!!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_png </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kiri Daust, Colin Mahony, Bruno Tremblay, Ceres Barros, Province of British Columbia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

