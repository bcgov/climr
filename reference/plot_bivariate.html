<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bivariate climate change plots — plot_bivariate • climr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bivariate climate change plots — plot_bivariate"><meta name="description" content="Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to:
show differences in climate change trends among global climate models (GCMs);
show the differences between multiple simulations of each model; and
compare simulated climate change to observed climate change in the 2001-2020 period.
All climate changes are relative to the 1961-1990 reference period normals."><meta property="og:description" content="Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to:
show differences in climate change trends among global climate models (GCMs);
show the differences between multiple simulations of each model; and
compare simulated climate change to observed climate change in the 2001-2020 period.
All climate changes are relative to the 1961-1990 reference period normals."><meta property="og:image" content="https://bcgov.github.io/climr/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>`climr` workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_beg.html">Beginner `climr` workflow</a></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_int.html">Intermediate `climr` workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/methods_downscaling.html">`climr` downscaling methods</a></li>
    <li><a class="dropdown-item" href="../articles/methods_mosaic.html">The climr mosaic of North American climatologies</a></li>
    <li><a class="dropdown-item" href="../articles/methods_ensembleSelection.html">Global climate model ensemble selection</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guidance</h6></li>
    <li><a class="dropdown-item" href="../articles/guidance_ensembleSelection.html">Climate model and scenario selection</a></li>
    <li><a class="dropdown-item" href="../articles/guidance_timeSeries.html">Gridded observational time series</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Known Issues</h6></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_DiscrepanciesWithClimateNA.html">Discrepancies with ClimateNA</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_customRefmap.html">Suboptimal handling of custom refmaps in `downscale_core`</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_spatialAnomaly.html">Spatial anomaly near Prince George in `refmap_climatena`</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Bivariate climate change plots</h1>

      <div class="d-none name"><code>plot_bivariate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bivariate plots of 21st century climate change for user-selected locations and climate variables.
The purposes of the plot are to:</p><ol><li><p>show differences in climate change trends among global climate models (GCMs);</p></li>
<li><p>show the differences between multiple simulations of each model; and</p></li>
<li><p>compare simulated climate change to observed climate change in the 2001-2020 period.</p></li>
</ol><p>All climate changes are relative to the 1961-1990 reference period normals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_bivariate</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  xvar <span class="op">=</span> <span class="st">"Tave_sm"</span>,</span>
<span>  yvar <span class="op">=</span> <span class="st">"PPT_sm"</span>,</span>
<span>  period_focal <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcm_periods</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  gcms <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcms</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  ssp <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_ssps</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  obs_period <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_obs_periods</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  gcm_periods <span class="op">=</span> <span class="fu"><a href="data-option-lists.html">list_gcm_periods</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_run <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  legend_pos <span class="op">=</span> <span class="st">"bottomleft"</span>,</span>
<span>  show_runs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_ensMean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_observed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_trajectories <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>data.table</code> object produced using the function <code><a href="plot_bivariate_input.html">plot_bivariate_input()</a></code>. This
table can include more models, scenarios, and variables than are used in individual calls to
<code>plot_bivariate()</code>.</p></dd>


<dt id="arg-xvar">xvar<a class="anchor" aria-label="anchor" href="#arg-xvar"></a></dt>
<dd><p>character. x-axis variable. options are <code><a href="data-option-lists.html">list_vars()</a></code>.</p></dd>


<dt id="arg-yvar">yvar<a class="anchor" aria-label="anchor" href="#arg-yvar"></a></dt>
<dd><p>character. y-axis variable. options are <code><a href="data-option-lists.html">list_vars()</a></code>.</p></dd>


<dt id="arg-period-focal">period_focal<a class="anchor" aria-label="anchor" href="#arg-period-focal"></a></dt>
<dd><p>character. The 20-year period for which to plot the ensemble
detail. options are <code><a href="data-option-lists.html">list_gcm_periods()</a></code>.</p></dd>


<dt id="arg-gcms">gcms<a class="anchor" aria-label="anchor" href="#arg-gcms"></a></dt>
<dd><p>character. Vector of global climate model names. Options are <code><a href="data-option-lists.html">list_gcms()</a></code>.</p></dd>


<dt id="arg-ssp">ssp<a class="anchor" aria-label="anchor" href="#arg-ssp"></a></dt>
<dd><p>character. A single SSP-RCP scenario (representative concentration pathways paired with shared socioeconomic pathways).
Options are <code><a href="data-option-lists.html">list_ssps()</a></code>. Defaults to SSP2-4.5.</p></dd>


<dt id="arg-obs-period">obs_period<a class="anchor" aria-label="anchor" href="#arg-obs-period"></a></dt>
<dd><p>character. A single 20-year period for observed climate data.
Options are <code><a href="data-option-lists.html">list_obs_periods()</a></code>.</p></dd>


<dt id="arg-gcm-periods">gcm_periods<a class="anchor" aria-label="anchor" href="#arg-gcm-periods"></a></dt>
<dd><p>character. 20-year reference periods for GCM simulations.
Options are <code><a href="data-option-lists.html">list_gcm_periods()</a></code>.</p></dd>


<dt id="arg-max-run">max_run<a class="anchor" aria-label="anchor" href="#arg-max-run"></a></dt>
<dd><p>integer. Maximum number of model runs to include, not including the ensemble mean.
Runs are included in the order they
are found in the models data until <code>max_run</code> is reached. Defaults to 0L.</p></dd>


<dt id="arg-legend-pos">legend_pos<a class="anchor" aria-label="anchor" href="#arg-legend-pos"></a></dt>
<dd><p>character. Position of the legend. Options are <code>c("bottomright", "bottom", "bottomleft", "left", "topleft", "top", "topright", "right", "center")</code>.</p></dd>


<dt id="arg-show-runs">show_runs<a class="anchor" aria-label="anchor" href="#arg-show-runs"></a></dt>
<dd><p>logical. If TRUE, the individual runs of the model are plotted (for
<code>period_focal</code> only) in addition to the single-model ensemble mean.</p></dd>


<dt id="arg-show-ensmean">show_ensMean<a class="anchor" aria-label="anchor" href="#arg-show-ensmean"></a></dt>
<dd><p>logical. If TRUE, the multi-model ensemble mean is plotted (for
<code>period_focal</code> only).</p></dd>


<dt id="arg-show-observed">show_observed<a class="anchor" aria-label="anchor" href="#arg-show-observed"></a></dt>
<dd><p>logical. If TRUE, the 2001-2020 observed climate is plotted.</p></dd>


<dt id="arg-show-trajectories">show_trajectories<a class="anchor" aria-label="anchor" href="#arg-show-trajectories"></a></dt>
<dd><p>logical. If TRUE, the values of the single-model ensemble
mean are plotted for all 20-year periods in <code><a href="data-option-lists.html">list_gcm_periods()</a></code>, connected by an
interpolation spline.</p></dd>


<dt id="arg-interactive">interactive<a class="anchor" aria-label="anchor" href="#arg-interactive"></a></dt>
<dd><p>logical. If TRUE, an interactive plot is generated using <code>{plotly}</code>.
If FALSE, a plot is generated using base graphics.</p></dd>


<dt id="arg-cache">cache<a class="anchor" aria-label="anchor" href="#arg-cache"></a></dt>
<dd><p>logical. Cache data locally? Default <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>NULL. Draws a plot in the active graphics device.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input table <code>X</code> provides climate data for a single location or the average of multiple
locations. The purpose of conducting the generation of the input table in a separate function is
to allow users to make multiple calls to <code>plot_bivariate()</code> without needing to generate the
inputs each time.</p>
<p>The climate change trajectories provided by <code>show_trajectories</code> are points for
each of the five 20-year periods specified by <code><a href="data-option-lists.html">list_gcm_periods()</a></code>. These points
are connected with an interpolation spline when the x variable is monotonic;
otherwise the trajectory points are connected by straight lines.
This plot is designed to be used with a single SSP scenario. If multiple scenarios
are passed to the plot, the GCM means and ensemble mean are averaged across the
scenarios, but the individual runs for all scenarios are plotted separately.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># data frame of arbitrary points on Vancouver Island</span></span></span>
<span class="r-in"><span><span class="va">my_points</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span></span>
<span class="r-in"><span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">123.4404</span>, <span class="op">-</span><span class="fl">123.5064</span>, <span class="op">-</span><span class="fl">124.2317</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">48.52631</span>, <span class="fl">48.46807</span>, <span class="fl">49.21999</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  elev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">103</span>, <span class="fl">357</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in data.table(lon = c(-123.4404, -123.5064, -124.2317), lat = c(48.52631,     48.46807, 49.21999), elev = c(52, 103, 357), id = seq_len(3)):</span> could not find function "data.table"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw the plot</span></span></span>
<span class="r-in"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="plot_bivariate_input.html">plot_bivariate_input</a></span><span class="op">(</span><span class="va">my_points</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to climr!</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'my_points' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw the plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_bivariate</span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'my_data' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw an interactive (plotly) plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_bivariate</span><span class="op">(</span><span class="va">my_data</span>, xvar<span class="op">=</span><span class="st">"MAT"</span>, yvar<span class="op">=</span><span class="st">"PAS_an"</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'my_data' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># export plot to a temporary directory</span></span></span>
<span class="r-in"><span><span class="va">figDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">figDir</span>, <span class="st">"plot_test.png"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"cairo"</span>, units <span class="op">=</span> <span class="st">"in"</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">5</span>, pointsize <span class="op">=</span> <span class="fl">10</span>, res <span class="op">=</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_bivariate</span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'my_data' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_record_1533633155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     2 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kiri Daust, Colin Mahony, Bruno Tremblay, Ceres Barros, Province of British Columbia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

