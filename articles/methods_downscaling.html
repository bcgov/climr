<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`climr` downscaling methods • climr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`climr` downscaling methods">
<meta name="description" content="A brief explanation of the downscaling  methdology used in `climr`
">
<meta property="og:description" content="A brief explanation of the downscaling  methdology used in `climr`
">
<meta property="og:image" content="https://bcgov.github.io/climr/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>`climr` workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_beg.html">Beginner `climr` workflow</a></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_int.html">Intermediate `climr` workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/methods_downscaling.html">`climr` downscaling methods</a></li>
    <li><a class="dropdown-item" href="../articles/methods_mosaic.html">The climr mosaic of North American climatologies</a></li>
    <li><a class="dropdown-item" href="../articles/methods_ensembleSelection.html">Global climate model ensemble selection</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guidance</h6></li>
    <li><a class="dropdown-item" href="../articles/guidance_ensembleSelection.html">Climate model and scenario selection</a></li>
    <li><a class="dropdown-item" href="../articles/guidance_timeSeries.html">Gridded observational time series</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Known Issues</h6></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_DiscrepanciesWithClimateNA.html">Discrepancies with ClimateNA</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_customRefmap.html">Suboptimal handling of custom refmaps in `downscale_core`</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_spatialAnomaly.html">Spatial anomaly near Prince George in `refmap_climatena`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>`climr` downscaling methods</h1>
            
      

      <div class="d-none name"><code>methods_downscaling.Rmd</code></div>
    </div>

    
    
<p>Downscaling is the process of converting low-spatial-resolution
climate data to high resolution. <code>climr</code> adapts a downscaling
approach originally implemented in <a href="https://climatena.ca/" class="external-link">ClimateNA</a> <span class="citation">(<a href="#ref-wang2016">Wang et al. 2016</a>)</span> by Dr. Tongli Wang
(University of British Columbia), Dr. Andreas Hamann (University of
Alberta), and Dave Spittlehouse (BC Ministry of Forests). This approach
downscales climate data in three stages:</p>
<ol style="list-style-type: decimal">
<li>
<em>Change-factor downscaling</em> of coarse-resolution (50-200km
grid) monthly temperature and precipitation data from climate models or
observational sources to high-resolution (1-4km grid);</li>
<li>
<em>Elevation adjustment</em> of temperature variables to provide
scales finer than the high-resolution reference grid; and</li>
<li>
<em>Calculating derived variables</em> from the downscaled monthly
temperature and precipitation variables.</li>
</ol>
<div class="section level4">
<h4 id="stage-1-change-factor-aka-delta-downscaling">Stage 1: change-factor (aka “delta”) downscaling<a class="anchor" aria-label="anchor" href="#stage-1-change-factor-aka-delta-downscaling"></a>
</h4>
<p><code>climr</code> uses a simple method called change-factor
downscaling. This method is sometimes referred to as the climate imprint
method <span class="citation">(<a href="#ref-hunter2005">Hunter and
Meentemeyer 2005</a>)</span>, the delta method <span class="citation">(<a href="#ref-wang2016">Wang et al. 2016</a>)</span>,
or simple mean bias correction <span class="citation">(<a href="#ref-maraun2016">Maraun 2016</a>)</span>. This method adds
low-spatial-resolution anomalies (e.g., from a climate model) to a
high-resolution gridded climate map (Tabor and Williams 2010). While
change-factor downscaling is too simplistic for downscaling of daily
time series or extremes indices, it is sufficient for downscaling
temperature and precipitation data at low temporal resolution (e.g.,
20-year climate averages).</p>
<p>The default high-resolution climate maps used by <code>climr</code>
are 800m gridded maps of mean daily maximum temperature
(T<sub>max</sub>), mean daily minimum temperature (T<sub>min</sub>), and
precipitation (PPT) for the 1961-1990 period. <code>climr</code> uses a
custom composite of climate maps from multiple sources: <a href="https://prism.oregonstate.edu/" class="external-link">PRISM Climate Group</a> (USA), <a href="https://www.pacificclimate.org/data/prism-climatology-and-monthly-timeseries" class="external-link">Pacific
Climate Impacts Consortium</a> (BC), and <a href="https://daymet.ornl.gov/" class="external-link">Daymet</a> (Mexico and Canada outside
BC). There is one map for each month of the year, for a total of 36
climate maps. Here is what the July T<sub>max</sub> reference map looks
like in the vicinity of Vancouver, BC.</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-1-1.png" alt="`climr` *1961-1990 reference climate map for July T~max~*" width="672"><p class="caption">
<code>climr</code> <em>1961-1990 reference climate map for July
T<sub>max</sub></em>
</p>
</div>
<p>Global climate model data are at much lower resolution (60-200km grid
scale). Here is the change in July T<sub>max</sub> for the EC-Earth3
global climate model for the 2041-2060 time period, relative to the
model’s 1961-1990 climate. In this case, the warming is greater in areas
further (eastward) from the coast.</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-2-1.png" alt="*Low-resolution anomalies (change) in July T~max~ for the EC-Earth3 global climate model for the 2041-2060 time period, relative to the model's 1961-1990 climate*" width="672"><p class="caption">
<em>Low-resolution anomalies (change) in July T<sub>max</sub> for the
EC-Earth3 global climate model for the 2041-2060 time period, relative
to the model’s 1961-1990 climate</em>
</p>
</div>
<p>To downscale the GCM projection, we first interpolate the
low-resolution GCM anomaly (in this case, the temperature change from
1961-1990 to 2041-2060) to the resolution of the detailed reference
climate map:</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-3-1.png" alt="*Interpolation of the low-resolution climate model anomalies to the same high resolution as the reference climate map.*" width="672"><p class="caption">
<em>Interpolation of the low-resolution climate model anomalies to the
same high resolution as the reference climate map.</em>
</p>
</div>
<p>Then we add these smoothed anomalies to the high-resolution 1961-1990
climate map, resulting in a high-resolution map of the simulated climate
in 2041-2060.</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-4-1.png" alt="*Downscaled 2041-2060 July T~max~ for the EC-Earth model, resulting from addition of the interpolated low-resolution model anomalies (change factors) to the high resolution 1961-1990 reference climate.*" width="672"><p class="caption">
<em>Downscaled 2041-2060 July T<sub>max</sub> for the EC-Earth model,
resulting from addition of the interpolated low-resolution model
anomalies (change factors) to the high resolution 1961-1990 reference
climate.</em>
</p>
</div>
<p>In the case of precipitation, we multiply the reference climate by
the relative anomaly (e.g., multiply by 1.07 for a 7% increase in
precipitation), rather than adding the absolute anomaly.</p>
<p>The example above illustrates how change-factor downscaling is able
to represent the effect of the ocean in reducing warming rates in
coastal areas, because this large-scale effect is represented at the
coarse resolution of in the global climate model. However, the
downscaling here produced a uniform warming rate from valley bottom to
mountain top. In reality, we would expect some large elevation-dependent
differences in warming rate due for example to changes in snowpack. The
inability to represent changes that occur at spatial scales smaller than
the (very large) global climate model grid cells is an important
weakness of change-factor downscaling and other statistical downscaling
methods. Similarly, change-factor downscaling can’t represent the role
of other fine-scale features like lakes, vegetation, cold-air pooling,
and soil moisture. These are important considerations when interpreting
the results of statistical downscaling.</p>
</div>
<div class="section level4">
<h4 id="stage-2-elevation-adjustment">Stage 2: Elevation adjustment<a class="anchor" aria-label="anchor" href="#stage-2-elevation-adjustment"></a>
</h4>
<p><code>climr</code> uses elevation adjustment to downscale temperature
variables to scales finer than the resolution of the reference climate
map. It does this by inferring a relationship between temperature and
elevation, known as a lapse rate, from the reference climate maps. The
local lapse rate is calculated for each grid cell of the reference
climate map using a linear regression of temperature to elevation among
the focal cell and its 8 neighbours. The gridded lapse rates are
included in the <code>SpatRaster</code> returned by the
<code><a href="../reference/input_refmap.html">input_refmap()</a></code> function used above. This is the
<code>climr</code> lapse rate layer for July T<sub>max</sub>:</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-5-1.png" alt="*July T~max~ lapse rates (change in temperature relative to elevation; ^o^C/m) used for elevation adjustment*" width="672"><p class="caption">
<em>July T<sub>max</sub> lapse rates (change in temperature relative to
elevation; <sup>o</sup>C/m) used for elevation adjustment</em>
</p>
</div>
<p>This example indicates that the BC PRISM maps for July
T<sub>max</sub> have lower lapse rates in maritime influenced mountains
(4<sup>o</sup>C/km) than in mountains with less maritime influence
(8<sup>o</sup>C/km). The map of lapse rates has artefacts in areas with
no relief; these artefacts have no consequence unless users supply
elevations for these areas that deviate substantially from realistic
ground elevations in areas of flat topography (e.g., asking
<code>climr</code> to provide climate values for 200m elevation on the
Fraser River delta, which is uniformly at sea level).</p>
<p>We can use the <code><a href="../reference/downscale.html">downscale()</a></code> function with a 90m digital
elevation model (DEM) to illustrate the elevation adjustment on
Vancouver’s north shore mountains, shown below.</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/figures-side-1.png" alt="*1961-1990 July T~max~ in the 800m reference clmate map (left) and elevation-adjusted to a 90m grid (right).*" width="672"><p class="caption">
<em>1961-1990 July T<sub>max</sub> in the 800m reference clmate map
(left) and elevation-adjusted to a 90m grid (right).</em>
</p>
</div>
<p>Elevation adjustment provides a visually appealing map and can be
useful in improving precision in climate values for points of interest
in areas of steep topography. However, it is important to remember that
the <code>climr</code> output only represents the effects of regional
climate and elevation. Microclimatic factors such as aspect, vegetation,
water bodies, frost pooling, and soil moisture are not represented in
these maps.</p>
<p>By default, <code>climr</code> doesn’t apply elevation adjustment to
precipitation, because in most cases elevation does not influence
precipitation at scales less than 1km. Instead, precipitation at scales
finer than 800m is simply interpolated from the nearest four grid points
in the reference map. Users can choose to apply elevation-adjustment to
precipitation by selecting <code>ppt_lr = TRUE</code> in the
<code><a href="../reference/downscale.html">downscale()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="stage-3-derived-variables">Stage 3: Derived variables<a class="anchor" aria-label="anchor" href="#stage-3-derived-variables"></a>
</h4>
<p>The value of delta downscaling isn’t just in obtaining the new
absolute values of temperature and precipitation. It allows us to
calculate anomalies in other indices that don’t scale linearly with
temperature or precipitation, such as degree-days or precipitation as
snow.</p>
<p><code>climr</code> currently uses the ClimateNA derived variable
equations <span class="citation">(<a href="#ref-wang2016">Wang et al.
2016</a>)</span>. These equations are developed by fitting non-linear
models of the relationship between the variable of interest calculated
from daily weather station data and monthly temperature and/or
precipitation at these weather stations. For example, the equations for
January degree-days below 0<sup>o</sup>C and 18<sup>o</sup>C are derived
by fitting a piecewise function of these variables to January mean
temperature for the 1961-1990 period at 4891 stations across North
America, shown below in Figure 4 from <span class="citation">Wang et al.
(<a href="#ref-wang2016">2016</a>)</span>:</p>
<div class="figure">
<img src="WangEtAl2016_Fig4.png" alt="Figure 4 from @wang2016, illustrating the derivation of equations for January degree-days below 0^o^C and 18^o^C based on January mean temperature at North American weather stations" width="70%"><p class="caption">
Figure 4 from <span class="citation">Wang et al. (<a href="#ref-wang2016">2016</a>)</span>, illustrating the derivation of
equations for January degree-days below 0<sup>o</sup>C and
18<sup>o</sup>C based on January mean temperature at North American
weather stations
</p>
</div>
<p>Using the <code>climr</code> output for the EC-Earth3 climate model,
we can compare the change in January mean temperature to change in
January degree days below 0<sup>o</sup>C in the 2041-2060 period
relative to the 1961-1990 baseline. January mean temperature is
interpolated directly from the GCM, so the only variation in the climate
change trend in this variable is the transition from one GCM grid cell
to its neighbours. In contrast, January degree-days below
0<sup>o</sup>C, while derived directly from January mean temperature,
has strong elevation-dependence in its climate change trend.</p>
<div class="figure">
<img src="methods_downscaling_files/figure-html/unnamed-chunk-7-1.png" alt="*Downscaled change in January mean temperature (left) and its derived variable January degree days below 0^o^C (right), using the EC-Earth model simulation for 2041-2060.*" width="672"><p class="caption">
<em>Downscaled change in January mean temperature (left) and its derived
variable January degree days below 0<sup>o</sup>C (right), using the
EC-Earth model simulation for 2041-2060.</em>
</p>
</div>
</div>
<div class="section level2">
<h2 id="climr-data-sources">
<code>climr</code> data sources<a class="anchor" aria-label="anchor" href="#climr-data-sources"></a>
</h2>
<div class="section level4">
<h4 id="high-resolution-climate-maps-used-by-climr">High-resolution climate maps used by <code>climr</code><a class="anchor" aria-label="anchor" href="#high-resolution-climate-maps-used-by-climr"></a>
</h4>
<p>The default climate maps for <code>climr</code> are a composite for
North America (2.4km grid scale). We compiled this composite from <a href="https://prism.oregonstate.edu/" class="external-link">PRISM Climate Group</a> (USA), <a href="https://www.pacificclimate.org/data/prism-climatology-and-monthly-timeseries" class="external-link">Pacific
Climate Impacts Consortium</a> (BC), and <a href="https://daymet.ornl.gov/" class="external-link">Daymet</a> (Canada outside BC). We
recommend this reference climate map for the following reasons: (1) the
800m resolution preserves localized lapse rates (e.g. temperature
inversions) that are averaged out by the 4km ClimateNA composite; (2)
the PRISM climatology for BC is preserved by blending outwards from the
BC border; (3) lapse rates in the Alberta Rockies are better defined;
and (4) T<sub>min</sub> for Washington, Idaho, and Montana are
reconstructed to correct for unrealistic lapse rates.</p>
<p><code>climr</code> provides two other options for the high-resolution
reference climate map:</p>
<ol style="list-style-type: decimal">
<li>The ClimateNA composite for North America, at 4km grid scale <span class="citation">(<a href="#ref-wang2016">Wang et al. 2016</a>)</span>.
This composite is compiled from separate PRISM climate surfaces for BC,
Alaska, Yukon/Alberta/Saskatchewan/Manitoba, and the contiguous US, and
WorldClim <span class="citation">(<a href="#ref-fick2017">Fick and
Hijmans 2017</a>)</span> in the remainder of the continent.</li>
<li>User-supplied climate maps. the <code><a href="../reference/downscale.html">downscale()</a></code> function
can accept any climate map as the reference normals. This allows the
user to provide their own reference climate maps, such as: (1)
Alternative publicly available gridded climatologies such as CHELSA,
Daymet, or Worldclim; (2) output of weather models (e.g., WRF); or (3)
custom super-high resolution climate maps for small study areas.</li>
</ol>
</div>
<div class="section level4">
<h4 id="historical-observational-time-series-and-climates">Historical observational time series and climates<a class="anchor" aria-label="anchor" href="#historical-observational-time-series-and-climates"></a>
</h4>
<p><code>climr</code> provides historical observed climates for annual
time series from 1901-present and for 10-year, 20-year, and 30-year
periods from 1951-2020. These are downscaled in the same way as global
climate model data: by adding low-resolution anomalies (change factors)
to the high-resolution reference climate map. Temperature anomalies are
from the Climatic Research Unit (CRU) Time Series dataset. Precipitation
anomalies are from the Global Precipitation Climatology Centre global
dataset, which has a better representation of Canadian precipitation
stations than the CRU Time Series dataset.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fick2017" class="csl-entry">
Fick, Stephen E., and Robert J. Hijmans. 2017. <span>“WorldClim 2: New
1<span>-</span>Km Spatial Resolution Climate Surfaces for Global Land
Areas.”</span> <em>International Journal of Climatology</em> 37 (12):
4302–15. <a href="https://doi.org/10.1002/joc.5086" class="external-link">https://doi.org/10.1002/joc.5086</a>.
</div>
<div id="ref-hunter2005" class="csl-entry">
Hunter, Richard D., and Ross K. Meentemeyer. 2005.
<span>“Climatologically Aided Mapping of Daily Precipitation and
Temperature.”</span> <em>Journal of Applied Meteorology</em> 44 (10):
1501–10. <a href="https://doi.org/10.1175/JAM2295.1" class="external-link">https://doi.org/10.1175/JAM2295.1</a>.
</div>
<div id="ref-maraun2016" class="csl-entry">
Maraun, Douglas. 2016. <span>“Bias Correcting Climate Change Simulations
- a Critical Review.”</span> <em>Current Climate Change Reports</em> 2
(4): 211–20. <a href="https://doi.org/10.1007/s40641-016-0050-x" class="external-link">https://doi.org/10.1007/s40641-016-0050-x</a>.
</div>
<div id="ref-wang2016" class="csl-entry">
Wang, Tongli, Andreas Hamann, Dave Spittlehouse, and Carlos Carroll.
2016. <span>“Locally Downscaled and Spatially Customizable Climate Data
for Historical and Future Periods for North America.”</span> Edited by
Inés Álvarez. <em>PLOS ONE</em> 11 (6): e0156720. <a href="https://doi.org/10.1371/journal.pone.0156720" class="external-link">https://doi.org/10.1371/journal.pone.0156720</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kiri Daust, Colin Mahony, Bruno Tremblay, Ceres Barros, Province of British Columbia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
