<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The climr mosaic of North American climatologies • climr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The climr mosaic of North American climatologies">
<meta name="description" content="Methods and evaluation of the 1981-2010 reference climate map for North America,  assembled from multiple data sources.
">
<meta property="og:description" content="Methods and evaluation of the 1981-2010 reference climate map for North America,  assembled from multiple data sources.
">
<meta property="og:image" content="https://bcgov.github.io/climr/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>`climr` workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_beg.html">Beginner `climr` workflow</a></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_int.html">Intermediate `climr` workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/methods_downscaling.html">`climr` downscaling methods</a></li>
    <li><a class="dropdown-item" href="../articles/methods_mosaic.html">The climr mosaic of North American climatologies</a></li>
    <li><a class="dropdown-item" href="../articles/methods_ensembleSelection.html">Global climate model ensemble selection</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guidance</h6></li>
    <li><a class="dropdown-item" href="../articles/guidance_ensembleSelection.html">Climate model and scenario selection</a></li>
    <li><a class="dropdown-item" href="../articles/guidance_timeSeries.html">Gridded observational time series</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Known Issues</h6></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_DiscrepanciesWithClimateNA.html">Discrepancies with ClimateNA</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_customRefmap.html">Suboptimal handling of custom refmaps in `downscale_core`</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_spatialAnomaly.html">Spatial anomaly near Prince George in `refmap_climatena`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The climr mosaic of North American climatologies</h1>
            
      

      <div class="d-none name"><code>methods_mosaic.Rmd</code></div>
    </div>

    
    
<p><img src="plots_mosaic/climr_mosaic_1981_2010_Tmax07.png" width="100%"></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>High-quality gridded climatologies (climate maps) of North America
are not currently available, despite the availability of high-quality
climate maps for BC and the continental US (the PRISM maps; <span class="citation">Daly et al. (<a href="#ref-daly2008">2008</a>)</span>).
Existing seamless maps made with a consistent methodology across North
America (WorldClim, Daymet, and CHELSA) exhibit unacceptable artefacts
in the complex topography of the western Cordillera. Analysts conducting
cross-border studies are faced with the dilemma of introducing boundary
artefacts associated with combining high-quality and low-quality
products from different jurisdictions, or alternatively foregoing
high-quality climate data to achieve cross-border continuity by using a
lower-quality product.</p>
<p>The need for a relatively seamless mosaic of the best available
gridded climatologies motivated the development of the ClimateNA mosaic
of 1961-1990 normals for North America (<span class="citation">Wang et
al. (<a href="#ref-wang2016">2016</a>)</span>), which has been widely
used for over a decade as part of the <a href="https://climatena.ca/" class="external-link">ClimateNA</a> downscaling product. During
the development of <code>climr</code>, we identified several
opportunities to complement the ClimateNA mosaic with an alternative
mosaic:</p>
<ul>
<li><p>Incorporate the recently developed 800m-resolution PRISM maps for
Alaska <a href="https://prism.oregonstate.edu/projects/public/alaska/report/ak_final_report_8110.pdf" class="external-link">(Daly
et al. 2018)</a>;</p></li>
<li><p>Use predictive models to blend outside the boundaries of PRISM
products, to avoid degrading these high-quality products by blending
with lower-quality products inside the PRISM domains;</p></li>
<li><p>Compile source climatologies exclusively of the 1981-2010 period,
to avoid artefacts associated with adjusting for different normal
periods in the source data;</p></li>
<li><p>Use a single product (Daymet) for central and eastern North
America to provide users with a seamless map for cross-border analyses
in that region; and</p></li>
<li><p>Compile a mosaic at higher resolution (2.5km instead of
ClimateNA’s 4km map) to conserve complex elevational relationships
(e.g. valley inversions) and precipitation patterns.</p></li>
</ul>
<p>In this article, we describe the method for development of the climr
mosaic of 1981-2010 North American Climatologies. We highlight some
regions where this new mosaic provides substantial improvement over the
ClimateNA mosaic. However, there are many regions where the ClimateNA
mosaic provides complementary information. For example, ClimateNA
provides a mosaic of the US PRISM and Worldclim maps for eastern North
America, which users may deem preferable to climr’s Daymet climatology
for some purposes. Also, since the ClimateNA maps are stored at lower
resolution (4km instead of climr’s 2.5km), their download speed and
cache size is 2.5 times less than the climr mosaic. For these reasons,
<code><a href="../reference/downscale.html">climr::downscale()</a></code> provides the option to downscale using
either the climr mosaic or the ClimateNA mosaic
(<code>which_refmap = c("refmap_climr", "refmap_climatena")</code>).</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>The climr mosaic is a composite of the 1981-2010 gridded climate maps
from the following sources (<a href="#fig1">Figure 1</a>):</p>
<ul>
<li><p><strong>PRISM for Western US</strong>—The Parameter-elevation
Regressions on Independent Slopes Model (PRISM; <span class="citation">Daly et al. (<a href="#ref-daly2008">2008</a>)</span>)
maps are recognized as the highest-quality gridded climatological
normals for the contiguous United States. We blended the US PRISM with
BC PRISM emulator (explained below) between latitudes 48<sup>o</sup>N
and 49<sup>o</sup>N.</p></li>
<li><p><strong>British Columbia PRISM</strong>—The BC PRISM (<span class="citation">Pacific Climate Impacts Consortium (<a href="#ref-pcic2014">2014</a>)</span>) is developed by the <a href="pacificclimate.org/data/prism-climatology-and-monthly-timeseries">Pacific
Climate Impacts Consortium</a> in collaboration with the PRISM Climate
Group (Oregon State University). It generally is highly compatible with
the US and Alaska PRISM products, with exceptions noted in the <a href="#apparent-tmin-artefacts-in-the-us-prism">Discussion section</a>.
The blending with the PRISM emulator along the northern, eastern, and
southern BC boundary does not compromise the integrity of the BC PRISM
since the emulator replicates the PRISM map in the blending
region.</p></li>
<li><p><strong>Alaska PRISM</strong>—The PRISM 1981-2010 climatological
maps for Alaska <a href="https://prism.oregonstate.edu/projects/public/alaska/report/ak_final_report_8110.pdf" class="external-link">(Daly
et al. 2018)</a> are the best available product, as a result of
exhaustive station data compilation and local expert review, and are
compatible with the BC PRISM.</p></li>
<li><p><strong>Daymet for eastern North America and
Mexico</strong>—While the US PRISM is likely preferable to Daymet over
the continental US, Daymet (<span class="citation">Thornton et al. (<a href="#ref-thornton2021">2021</a>)</span>) provides north-south
continuity across Canada, USA, and Mexico. Daymet was chosen over other
North American gridded climatologies (WorldClim and CHELSA) due to its
relative quality and the availability of a 1981-2010 normal
period.</p></li>
<li><p><strong>PRISM Emulator in Yukon and Northwest
Territories</strong>—We evaluated all available climatological maps for
the Yukon and Northwest Territories (WorldClim, CHELSA, Daymet, NRCAN
ANUSPLIN, and Western Canadian 4km 1961-1990 PRISM). None of these
products were of acceptable quality due to very low weather station
density. To provide a PRISM-compatible estimation of climate in this
region, we trained deep learning models on the BC and Alaska PRISM maps
and predicted them into the Yukon and NWT. This method is described in
more detail <a href="#prism-emulator-for-the-yukon-and-northwest-territories">below</a>.</p></li>
<li><p><strong>Predictive blending in Northern Mexico</strong>—The US
PRISM and Daymet maps require blending at the US-Mexico border to avoid
boundary artefacts. Rather than blending Daymet into the US PRISM, which
would degrade the PRISM map, we used machine learning (Random Forest
regression) to interpolate between PRISM and Daymet in a broad swath of
Northern Mexico. This is a less sophisticated approach to PRISM
emulation than used in the Yukon and NWT, but it is much more
computationally efficient and produced acceptable results. This method
is described in more detail <a href="#predictive-blending-for-northern-mexico">below</a>.</p></li>
<li><p><strong>20km Coastal buffer</strong>—We extended the coastal
climate values outwards into the ocean to a distance of 20km from shore.
We retained existing coastal buffers present in the PRISM products and
extended their outer limit where necessary. This buffer ensures climate
values are available in outer coastal land areas, but is not intended to
estimate temperature and precipitation over the ocean.</p></li>
</ul>
<div id="fig1">
<div class="figure">
<img src="plots_mosaic/climr_mosaic_dataSources.png" alt="Figure 1. Elements of the climr mosaic of 1981-2010 climatologies. PRISM and Daymet are publicly available datasets. The PRISM Emulator and predictive blending were developed as part of the climr mosaic method and are described in this article. Blending between products is as shown. " width="100%"><p class="caption">
Figure 1. Elements of the climr mosaic of 1981-2010 climatologies. PRISM
and Daymet are publicly available datasets. The PRISM Emulator and
predictive blending were developed as part of the climr mosaic method
and are described in this article. Blending between products is as
shown.
</p>
</div>
</div>
<div class="section level3">
<h3 id="prism-emulator-for-the-yukon-and-northwest-territories">PRISM emulator for the Yukon and Northwest Territories<a class="anchor" aria-label="anchor" href="#prism-emulator-for-the-yukon-and-northwest-territories"></a>
</h3>
<p>Generative Adversarial Networks (GANs; <span class="citation">Goodfellow et al. (<a href="#ref-goodfellow2014">2014</a>)</span>) are a deep learning
technique originally developed for computer vision that has recently
been applied to downscaling hourly weather simulations. While this
approach has not been applied to climate mapping, it is appealing for
this application because of its ability to make predictions of spatial
patterns, rather than just point estimates. In this way, GANs can be
used to emulate the spatial structures of a climatological mapping
technique such as PRISM and thus provide a more seamless extrapolation
of PRISM mapping into unmapped regions. While GAN-predicted
climatologies are not a substitute for supervised climatological maps
such as PRISM, they provide an interim solution where acceptable climate
maps have not been developed, as in the Yukon and Northwest
Territories.</p>
<p>We used a stochastic implementation of GANs (<span class="citation">Daust and Monahan (<a href="#ref-daust2024">2024</a>)</span>) to interpolate between the
Alaska/BC PRISM maps and the Daymet maps east of longitude
112<sup>o</sup>E. One GAN model was created for each climate variable
(e.g., January precipitation). The PRISM and Daymet maps for the target
variable were combined into a predictand layer. As predictors, we used
the WorldClim (<span class="citation">Fick and Hijmans (<a href="#ref-fick2017">2017</a>)</span>) climatology for the target
variable as well as latitude, longitude, elevation, and coastal
proximity. We ran each GAN to 150 epochs (training iterations), as
trials indicated that further epochs were generally not warranted. We
created three stochastic models for the months of March, June,
September, and December as a means of mapping prediction uncertainty.
Our models of precipitation exhibited artefacts along the arctic coast
that required local substitution with a random forest prediction.</p>
<p>Evaluation and refinement of the PRISM emulator method is ongoing. It
would likely be preferable to use weather model simulations (such as
ERA5 and/or the Weather Research and Forecasting (WRF) model) as
predictor variables rather than WorldClim, which likely confounds
training due to spatially inconsistent climate mapping. Further, we
intend to produce multiple realizations of all months (not just four) to
provide comprehensive uncertainty mapping. Finally, we need to resolve
the artefacts in predicted precipitation along the arctic coast.</p>
</div>
<div class="section level3">
<h3 id="predictive-blending-for-northern-mexico">Predictive blending for northern Mexico<a class="anchor" aria-label="anchor" href="#predictive-blending-for-northern-mexico"></a>
</h3>
<p>The objective of predictive blending was to produce a seamless
transition from the US PRISM to Daymet south of the US Border, to avoid
compromising the integrity of the US PRISM. We trained one Random Forest
(<span class="citation">Breiman (<a href="#ref-breiman2001">2001</a>)</span>) regression model for each
variable. The US PRISM south of 35<sup>o</sup>N and Daymet between
25-28<sup>o</sup>N were combined into a predictand layer. As predictors
for each variable, we used the Daymet and WorldClim (<span class="citation">Fick and Hijmans (<a href="#ref-fick2017">2017</a>)</span>) climatologies for Tmin, Tmax, and
precipitation of the target month and the two adjacent months (i.e.,
Jan-Feb-Mar for the target month of February); using multivariate
climate predictors allowed the exclusion of latitude and longitude as
predictors, which caused prediction artefacts during trials. Daymet
contains precipitation artefacts on the Baja peninsula; for this small
region we trained a separate model to blend PRISM precipitation into
WorldClim precipitation.</p>
</div>
<div class="section level3">
<h3 id="grid-resolution">Grid resolution<a class="anchor" aria-label="anchor" href="#grid-resolution"></a>
</h3>
<p>We aggregated the BC PRISM 30-arcsecond (approx 800m) grid to
90-arcsecond (approx. 2.5km) resolution and extended this grid to North
America. All other products were resampled to this grid using bilinear
interpolation. The 2.5km grid scale reduces downloading and storage by a
factor of 9, while retaining sufficient information for the original
PRISM and Daymet temperature maps to be recreated at 800m and finer
resolutions through climr’s elevation adjustment with inferred lapse
rates. <code>climr</code> does not apply an elevation adjustment to
precipitation, and as a result the spatial pattern of PRISM
precipitation is slightly degraded at this coarser resolution (see <a href="#fig4">Figure 4</a>. We are assessing whether the finer-resolution
details of PRISM precipitation are warranted.</p>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>This section provides a brief illustration of the climr mosaic in
case study regions. ClimateNA output, sourced from a direct query to
ClimateNA (<span class="citation">Wang et al. (<a href="#ref-wang2016">2016</a>)</span>), is provided for comparison since
the ClimateNA mosaic is available in <code>climr</code> as an
alternative reference climatology.</p>
<div class="section level3">
<h3 id="yukon-territory">Yukon Territory<a class="anchor" aria-label="anchor" href="#yukon-territory"></a>
</h3>
<p><a href="#fig2">Figure 2 (left panel)</a> illustrates the challenge
of combining climate maps made using different methodologies (i.e.,
PRISM vs Daymet) in a region of very low station density. While Daymet
and PRISM have similar January temperatures (Tmax) at low elevations
where weather stations are located, they have opposite lapse rates
resulting in divergent temperatures at higher elevations (Daymet colder
and PRISM warmer). In addition, the automated lapse rate calculation in
Daymet produces regions of no elevational variation in temperature. In
short, Daymet and PRISM are incompatible; blending them would degrade
PRISM in the blending zones and create a discontinuity in the mosaic
that would confound downstream analysis. In contrast, the GAN prediction
(PRISM emulator) produces a visually credible interpolation of the BC
and Alaska PRISM maps <a href="#fig2">Figure 2 (right panel)</a>. We
have not yet conducted a quantitative evaluation of the GAN predictions
relative to station data and other observational evidence.</p>
<div id="fig2">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_yukon_climrOnly_Tmax01.png" alt="Figure 2. Source data and prediction of the PRISM emulator for January Tmax (i.e., monthly mean daily maximum temperature) in southwest Yukon." width="100%"><p class="caption">
Figure 2. Source data and prediction of the PRISM emulator for January
Tmax (i.e., monthly mean daily maximum temperature) in southwest Yukon.
</p>
</div>
</div>
<p><a href="#fig3">Figure 3</a> provides further perspective on the
PRISM emulator relative to other data sources, using January Tmin as an
example. The ClimateNA mosaic (bottom panel) uses a blend of the BC
PRISM with a legacy 1961-1990 4km Western Canadian PRISM for the Yukon.
This degrades the BC PRISM in the 50km overlap region of northern BC and
the differences in the two datasets confound cross-border analysis. The
PRISM emulator (centre panel) produces a preferable mosaic, but it is
not ideal. The centre of the image exhibits an abrupt, dubious
transition from negative lapse rates (warm valleys, cold mountains) in
BC to positive (inverted) lapse rates in the Yukon. This demonstrates
the need for a more sophisticated PRISM emulation method. Further, it
emphasizes that the PRISM emulator is not a substitute for the PRISM
methodology.</p>
<div id="fig3">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_yukon_horiz_Tmin01.png" alt="Figure 3. Comparison of climr and ClimateNA mosaics to source data for January Tmin in southwest Yukon." width="100%"><p class="caption">
Figure 3. Comparison of climr and ClimateNA mosaics to source data for
January Tmin in southwest Yukon.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="bc-alberta-border">BC-Alberta border<a class="anchor" aria-label="anchor" href="#bc-alberta-border"></a>
</h3>
<p><a href="#fig4">Figure 4</a> shows the results of the PRISM emulator
along the BC-Alberta border at latitude 52-54.5<sup>o</sup>N. As in the
Yukon, the PRISM emulator provides a credible extrapolation outside the
BC border, avoding the need to blend an inferior map into the BC PRISM
domain. Notably, ClimateNA is not able to recover spatial resolution
through elevation adjustment, and the climatology of the Rocky Mountains
is degraded as a result. The weather stations demonstrate the challenge
of climate mapping in this region: Weather stations are exclusively at
low elevations, providing little support for automatic lapse rate
calculation used by WorldClim and Daymet. This emphasizes the necessity
for expert-supervised climatological mapping methods such as PRISM.</p>
<div id="fig4">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_bcab_Tmax07.png" alt="Figure 4. Comparison of climr and ClimateNA mosaics to source data for July Tmax at the continental divide boundary of southern BC and Alberta. Filled circles are weather stations with 1981-2010 normals following the same colour scheme." width="100%"><p class="caption">
Figure 4. Comparison of climr and ClimateNA mosaics to source data for
July Tmax at the continental divide boundary of southern BC and Alberta.
Filled circles are weather stations with 1981-2010 normals following the
same colour scheme.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="bc-us-border">BC-US border<a class="anchor" aria-label="anchor" href="#bc-us-border"></a>
</h3>
<p>The BC and US PRISM products are highly compatible for precipitation
and Tmax, and generally result in a seamless transition at the 49th
parallel <a href="#fig5">Figure 5</a>. Since precipitation is not
elevation-adjusted by default in climr, aggregating the climr mosaic to
2.5km resolution results in a blurring of the PRISM precipitation map
(Figure 5, center panel). We are not aware of observational or
theoretical evidence to support precipitation gradients at less than 3km
resolution in BC, except in dry valleys where virga (evaporation of
precipitation as it falls) could contribute to elevational gradients in
precipitation. As a result, this blurring in the climr mosaic likely is
generally acceptable. ClimateNA does apply elevation adjustment to
precipitation, as shown in the bottom panel of Figure 5, which results
in some valleys being drier than the original PRISM product. The climr
<code><a href="../reference/downscale.html">downscale()</a></code> function provides an option for elevation
adjustment of precipitation (<code>ppt_lr = TRUE</code>) in both the
climr and ClimateNA mosaics.</p>
<div id="fig5">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_bcus_Pr01.png" alt="Figure 5. Comparison of climr and ClimateNA mosaics to source data for January precipitation along the boundary of southern BC and Washington State." width="100%"><p class="caption">
Figure 5. Comparison of climr and ClimateNA mosaics to source data for
January precipitation along the boundary of southern BC and Washington
State.
</p>
</div>
</div>
<p>The BC and US PRISM products are significantly different for Tmin, as
shown in <a href="#fig6">Figure 6</a> (top panel) for January Tmin. The
BC PRISM generally exhibits straightforward negative lapse rates (warm
valleys, cold mountaintops), while the US PRISM exhibits a double
reversal of elevational temperature gradients (warm-cool-warm-cool with
elevation) in eastern and western portions of the image. This is likely
an unintended artefact of the two-layer atmosphere technique employed in
the US PRISM as a way of modeling the valley inversions (cold valleys,
warm midslopes, cold mountaintops) that are common throughout the
western United States. We investigate the evidence for the
double-reversed lapse rates in the <a href="#apparent-tmin-artefacts-in-the-us-prism">known issues section</a>
of this article. We did not find compelling evidence for these gradients
based on a preliminary examination of station data, though further
investigation would be required to rule them out.</p>
<p>Assuming that the double-reversed Tmin gradients are an artefact,
some reduction in their prominence is desirable, and will contribute to
more coherence between the BC and US components of the climr mosaic. Two
aspects of the mosaic method contribute to a dampening of the Tmin
gradients. First, the PRISM emulator was used to blend the BC and US
PRISM between 48<sup>o</sup>N and 49<sup>o</sup>N. Second, the
aggregation of the mosaic from 800m PRISM resolution to 2.5km resolution
smooths the sharp gradient reversals. The recalculation of the climr
mosaic at 800m resolution removes the gradient reversals, but does
result in some regions with very low lapse rates (Figure 6, centre
panel). This smoothing effect is more pronounced evident in the
ClimateNA mosaic (Figure 6, bottom panel), where the 4km resolution of
the ClimateNA mosaic results in loss of non-artefactual features such as
the Columbia River valley and its tributaries at the far right of the
image.</p>
<div id="fig6">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_bcus_Tmin07.png" alt="Figure 6. Comparison of climr and ClimateNA mosaics to source data for July Tmin along the boundary of southern BC and Washington State." width="100%"><p class="caption">
Figure 6. Comparison of climr and ClimateNA mosaics to source data for
July Tmin along the boundary of southern BC and Washington State.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="alberta-us-border">Alberta-US border<a class="anchor" aria-label="anchor" href="#alberta-us-border"></a>
</h3>
<p>Daymet and PRISM precipitation have a different character over the
prairies (<a href="#fig7">Figure 7</a>). PRISM precipitation is smooth,
with blotches due to variability between weather stations. Daymet
precipitation does not have obvious station artefacts, but has
fine-scale features such as drier coulees/ravines that may or may not
reflect reality (e.g., due to virga). To the extent that cross-border
consistency is important to downstream analyses, it is beneficial to
have a consistent product (Daymet) or method (PRISM) in the mosaic where
possible. Providing both the ClimateNA and climr mosaics in climr gives
users the option to select a product that best meets their needs.</p>
<p>The climr and ClimateNA mosaics both have an apparent discontinuity
in January precipitation across the Canada-US Border. This discontinuity
is also present in December and February. Since Daymet applies a
consistent method across the border, this discontinuity is not simply a
blending artefact. We have not yet established the reason for this
effect and whether it is real.</p>
<div id="fig7">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_Prairies_Pr01.png" alt="Figure 7. Comparison of climr and ClimateNA mosaics to source data for July Precipitation along the Alberta-US boundary." width="100%"><p class="caption">
Figure 7. Comparison of climr and ClimateNA mosaics to source data for
July Precipitation along the Alberta-US boundary.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="us-mexico-border">US-Mexico border<a class="anchor" aria-label="anchor" href="#us-mexico-border"></a>
</h3>
<p>Predictive blending is able to create a visually seamless transition
from the US PRISM to Daymet over northwestern Mexico (<a href="#fig8">Figure 8</a>). The climatology of January precipitation in
the climr mosaic is drier than in the ClimateNA mosaic along the west
coast of mainland Mexico and in the Colorado river delta at the north
end of the Gulf of California. We have not yet evaluated which is more
consistent with station observations.</p>
<div id="fig8">
<div class="figure">
<img src="plots_mosaic/mosaics_compare_nMex_Pr01.png" alt="Figure 8. Comparison of climr and ClimateNA mosaics to source data for January Precipitation along the US-Mexico boundary." width="100%"><p class="caption">
Figure 8. Comparison of climr and ClimateNA mosaics to source data for
January Precipitation along the US-Mexico boundary.
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="discussion-and-known-issues">Discussion and known Issues<a class="anchor" aria-label="anchor" href="#discussion-and-known-issues"></a>
</h2>
<p>Evaluation and refinement of the climr mosaic is ongoing. This
section discusses known issues that require further work.</p>
<div class="section level3">
<h3 id="double-reversed-tmin-lapse-rates-in-the-us-prism">Double-reversed Tmin lapse rates in the US PRISM<a class="anchor" aria-label="anchor" href="#double-reversed-tmin-lapse-rates-in-the-us-prism"></a>
</h3>
<p>As noted above, the US PRISM maps exhibit a double reversal of Tmin
lapse rates (warm-cool-warm-cool with increasing elevation) in many
regions of Montana, Idaho, and Washington State. This PRISM pattern may
be an unintended artefact of PRISM’s two-layer atmosphere technique used
to model valley inversions, in which different lapse rates are derived
above and below an altitude of 250m above a regional base elevation
(<span class="citation">Daly et al. (<a href="#ref-daly2008">2008</a>)</span>).</p>
<p>To investigate whether there is evidence for the double reversal, we
compared elevation-Tmin relationships of station data and PRISM in four
regions spanning the BC-US Border. The comparison for January Tmin is
shown in <a href="#fig9">Figure 9</a>. In the West Kootenay region of BC
(region 1), the station data strongly supports the monotonic negative
lapse rate of ~-5<sup>o</sup>C/km employed by the BC PRISM. In the BC
Rocky Mountains (Region 2), the station data is more ambiguous, and the
BC PRISM uses a weaker monotonic lapse rate of ~-2<sup>o</sup>C/km in
the southern portion of this region. South of the border in Washington
State (Region 3), There are two groups of stations. Stations below 1100m
elevation demonstrate a strong lapse rate of ~-5<sup>o</sup>C/km
consistent with the Region 1 stations. The stations above 1100m are
ambiguous. The US PRISM applies a strong lapse rate at these elevations
(visible in the grey dots) requiring a double reversal of lapse rates.
However, the station data as portrayed here would also be consistent
with a weak lapse rate above 1100m, requiring no lapse rate
reversals.</p>
<p>We investigated other months, and smaller subregions of regions 3 and
4, and found no compelling evidence for a double reversal of lapse
rates. However, our analysis doesn’t account for topographic position of
stations and other factors that could improve detection of complex lapse
rates. Consequently, we can’t rule out the presence of double-reversed
lapse rates.</p>
<p>Discussion with the developers of the US PRISM (Chris Daly, pers.
comm., January 9, 2025) indicated three points: (1) a double reversal of
lapse rates is possible, (2) the two-layer PRISM method can produce
double-reversed temperature profiles as an artefact of sparse station
data, and (3) definitive evidence for double-reversed temperature
profiles is not available. Given this ambiguity, the simplification of
the lapse rates that results from aggregating the climr mosaic to 2.5km
seems justifiable. In absence of definitive evidence, the climr-modified
lapse rates and the original PRISM can reasonably be considered as
alternative interpretations of ambiguous station data.</p>
<div id="fig9">
<div class="figure">
<img src="plots_mosaic/prism_US_lapserates_raw_Tmin01.png" alt="Figure 9. Evaluation of January Tmin lapse rates in the BC PRISM (areas 1 &amp; 2) and US PRISM (areas 3 and 4). Black dots on the map are weather station locations. Bottom panels show the relationship of temperature to elevation in the PRISM grid cells (grey dots) and stations (black dots) within each of the four numbered square areas on the map. The line and stated slope are a linear best fit to the station data." width="100%"><p class="caption">
Figure 9. Evaluation of January Tmin lapse rates in the BC PRISM (areas
1 &amp; 2) and US PRISM (areas 3 and 4). Black dots on the map are
weather station locations. Bottom panels show the relationship of
temperature to elevation in the PRISM grid cells (grey dots) and
stations (black dots) within each of the four numbered square areas on
the map. The line and stated slope are a linear best fit to the station
data.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="extrapolation-uncertainty-in-the-prism-emulator">Extrapolation uncertainty in the PRISM emulator<a class="anchor" aria-label="anchor" href="#extrapolation-uncertainty-in-the-prism-emulator"></a>
</h3>
<p>The GAN models are trained on the PRISM climate map for BC and
Alaska. Prediction into distant areas of the Yukon and Northwest
Territories is an extrapolation subject to error associated with novel
climate regimes. To estimate extrapolation uncertainty, we trained three
GAN models each for March, June, October, and December. Since the models
are stochastic, the intermodel variation likely is an indicator of novel
conditions (combinations of predictor values such as topography and
climate). In the example of June precipitation (<a href="#fig10">Figure
10</a>), there generally is very low intermodel variation in the
training areas of BC and Alaska and high intermodel variation in the
MacKenzie mountains. While we chose a single model prediction for the
climr mosaic, this analysis of prediction variability indicates that
there are spatially variable patterns of extrapolation error in the
climr mosaic for Yukon and NWT. We intend to provide users with
uncertainty maps in future versions of climr, and to refine our
selection of GAN models to conserve the annual cycle of climatic
variation at each location.</p>
<div id="fig10">
<div class="figure">
<img src="plots_mosaic/GAN_stdev_PPT06.png" alt="Figure 10. Standard deviation of June precipitation predictions from three deep learning models in the western arctic. Darker colors indicate higher variation among predictions, which likely is a proxy for prediction uncertainty." width="80%"><p class="caption">
Figure 10. Standard deviation of June precipitation predictions from
three deep learning models in the western arctic. Darker colors indicate
higher variation among predictions, which likely is a proxy for
prediction uncertainty.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="month-to-month-consistency-in-the-prism-emulator">Month-to-month consistency in the PRISM emulator<a class="anchor" aria-label="anchor" href="#month-to-month-consistency-in-the-prism-emulator"></a>
</h3>
<p>Our current PRISM emulation method uses a separate GAN model for each
month of each climate element (e.g., January Tmin). Extrapolation errors
are therefore not consistent across months. These temporal
inconsistencies can produce artefacts in the seasonal cycle of each
climate element at some locations (e.g., April colder than March) and
unrealistic variation in lapse rates among adjacent months. While
temporal inconsistencies are minor for temperature, they are more
pronounced for precipitation. We are developing a more sophisticated
method of PRISM emulation that provides temporal consistency between
adjacent months, and will update the climr mosaic when possible. Until
then, users should be corroborate the seasonal cycle of climr data with
other evidence for their locations of interest in the Yukon and
Northwest Territories.</p>
</div>
<div class="section level3">
<h3 id="alberta-foothills">Alberta foothills<a class="anchor" aria-label="anchor" href="#alberta-foothills"></a>
</h3>
<p>The PRISM emulator for western Alberta is trained on the windward
side of the Rocky Mountains (BC) and predicted onto the leeward side
(Alberta). This raises the concern of extrapolation errors due to
underestimation of processes such as continental air mass influence,
rainshadow effects, and chinook winds. The prediction does incorporate
Alberta climate (WorldClim) as a predictor, but given the sparsity of
station data used by WorldClim this is unlikely to substantially
mitigate extrapolation errors in most locations. We believe that the
PRISM emulator is preferable to other products for most uses because of
its cross-border compatibility and more realistic spatial detail.
However, users should be aware that the climr mosaic for the Alberta
foothills is poorly constrained by station data and is not yet
validated. We are developing improved methods of PRISM emulation that
will address these limitations.</p>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>We gratefully acknowledge the developers of the component
climatologies in the climr mosaic, namely the <a href="pacificclimate.org/data/prism-climatology-and-monthly-timeseries">Pacific
Climate Impacts Consortium</a> (British Columbia PRISM maps), the <a href="https://prism.oregonstate.edu/" class="external-link">PRISM Climate Group</a> (US PRISM
maps), the <a href="https://daymet.ornl.gov/" class="external-link">NASA Oak Ridge National
Laboratory</a> (Daymet), and <a href="https://www.worldclim.org/" class="external-link">WorldClim</a>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-breiman2001" class="csl-entry">
Breiman, Leo. 2001. <span>“Random Forests.”</span> <em>Machine
Learning</em> 45 (1): 5–32.
</div>
<div id="ref-daly2008" class="csl-entry">
Daly, C., M. Halbleib, J. I. Smith, W. P. Gibson, M. K. Doggett, G. H.
Taylor, J. Curtis, and P. A. Pasteris. 2008. <span>“Physiographically
Sensitive Mapping of Climatological Temperature and Precipitation Across
the Conterminous United States.”</span> <em>International Journal of
Climatology</em> 28 (15): 2031–64. <a href="https://doi.org/10.1002/joc.1688" class="external-link">https://doi.org/10.1002/joc.1688</a>.
</div>
<div id="ref-daust2024" class="csl-entry">
Daust, Kiri, and Adam Monahan. 2024. <span>“Capturing Climatic
Variability: Using Deep Learning for Stochastic Downscaling.”</span>
<em>arXiv</em> 2406.02587 (April). <a href="https://doi.org/10.48550/arXiv.2406.02587" class="external-link">https://doi.org/10.48550/arXiv.2406.02587</a>.
</div>
<div id="ref-fick2017" class="csl-entry">
Fick, Stephen E., and Robert J. Hijmans. 2017. <span>“WorldClim 2: New
1<span>-</span>Km Spatial Resolution Climate Surfaces for Global Land
Areas.”</span> <em>International Journal of Climatology</em> 37 (12):
4302–15. <a href="https://doi.org/10.1002/joc.5086" class="external-link">https://doi.org/10.1002/joc.5086</a>.
</div>
<div id="ref-goodfellow2014" class="csl-entry">
Goodfellow, Ian J., Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David
Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. 2014.
<span>“Generative Adversarial Networks.”</span> <em>arXiv Preprint</em>
arXiv:1406.2661. <a href="https://arxiv.org/abs/1406.2661" class="external-link">https://arxiv.org/abs/1406.2661</a>.
</div>
<div id="ref-pcic2014" class="csl-entry">
Pacific Climate Impacts Consortium. 2014. <span>“High-Resolution
1981-2010 Gridded Precipitation and Temperature Climatologies for
British Columbia.”</span> <em>Unpublished</em>. <a href="https://www.pacificclimate.org/data/prism-climatology-and-monthly-timeseries" class="external-link">https://www.pacificclimate.org/data/prism-climatology-and-monthly-timeseries</a>.
</div>
<div id="ref-thornton2021" class="csl-entry">
Thornton, P. E., R. Shrestha, M. Thornton, S.-C. Kao, Y. Wei, and B. E.
Wilson. 2021. <span>“Gridded Daily Weather Data for North America with
Comprehensive Uncertainty Quantification.”</span> <em>Scientific
Data</em> 8 (190): 1–17. <a href="https://doi.org/10.1038/s41597-021-00973-0" class="external-link">https://doi.org/10.1038/s41597-021-00973-0</a>.
</div>
<div id="ref-wang2016" class="csl-entry">
Wang, Tongli, Andreas Hamann, Dave Spittlehouse, and Carlos Carroll.
2016. <span>“Locally Downscaled and Spatially Customizable Climate Data
for Historical and Future Periods for North America.”</span> Edited by
Inés Álvarez. <em>PLOS ONE</em> 11 (6): e0156720. <a href="https://doi.org/10.1371/journal.pone.0156720" class="external-link">https://doi.org/10.1371/journal.pone.0156720</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kiri Daust, Colin Mahony, Bruno Tremblay, Ceres Barros, Province of British Columbia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
