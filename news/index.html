<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • climr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://bcgov.github.io/climr/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>`climr` workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_beg.html">Beginner `climr` workflow</a></li>
    <li><a class="dropdown-item" href="../articles/climr_workflow_int.html">Intermediate `climr` workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methods</h6></li>
    <li><a class="dropdown-item" href="../articles/methods_downscaling.html">`climr` downscaling methods</a></li>
    <li><a class="dropdown-item" href="../articles/methods_mosaic.html">The climr mosaic of North American climatologies</a></li>
    <li><a class="dropdown-item" href="../articles/methods_ensembleSelection.html">Global climate model ensemble selection</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guidance</h6></li>
    <li><a class="dropdown-item" href="../articles/guidance_ensembleSelection.html">Climate model and scenario selection</a></li>
    <li><a class="dropdown-item" href="../articles/guidance_timeSeries.html">Gridded observational time series</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Known Issues</h6></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_DiscrepanciesWithClimateNA.html">Discrepancies with ClimateNA</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_customRefmap.html">Suboptimal handling of custom refmaps in `downscale_core`</a></li>
    <li><a class="dropdown-item" href="../articles/knownIssues_spatialAnomaly.html">Spatial anomaly near Prince George in `refmap_climatena`</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Changelog</h1>

    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.2" id="climr-022">
<code>climr</code> 0.2.2<a class="anchor" aria-label="anchor" href="#climr-022"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-2-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-2"></a></h3>
<ul><li>Various minor bug fixes to plotting functions, predominantly for use in the climr-app</li>
<li>Added MSWX dataset to <code>plot_timeSeries</code>
</li>
<li>Fixed very strange mystery bug due to postgres not preserving row order</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-2-2">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-2-2"></a></h3>
<ul><li>Updated some climate variable names to specify annual timeperiod (e.g. <code>PAS</code> –&gt; <code>PAS_an</code>). Please see <code><a href="../reference/data-option-lists.html">list_vars()</a></code> for the updated names.</li>
<li>When downscaling SpatRasters, new variables are now added by reference, which substantially reduces memory foot print and prevents crashes.</li>
<li>Added database retry function (hopefully fixes issues on internal government networks)</li>
<li>Added <code>pre_cache</code> function for efficiently downloading data fro an AOI to avoid delays in analysis.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.1" id="climr-021">
<code>climr</code> 0.2.1<a class="anchor" aria-label="anchor" href="#climr-021"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-2-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-1"></a></h3>
<ul><li>Fixed a bug in <code><a href="../reference/plot_timeSeries.html">plot_timeSeries()</a></code> that prevented plotting of mswx.blend dataset</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-2-1">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-2-1"></a></h3>
<ul><li>New function “plot_WalterLieth” for creating a Walter-Lieth climate diagram for a specified location(s) and time periods.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="climr-020">
<code>climr</code> 0.2.0<a class="anchor" aria-label="anchor" href="#climr-020"></a></h2>
<p>We have lots of exciting improvements in this release! Of major note, we now have: - Native raster downscaling, allowing SpatRaster elevation input, and returning a SpatRaster stack of downscaled variables at user-specified resolution - Optional in-database downscaling. This is especially useful for reducing the time required for downscaling timeseries data - An updated climr mosaic base climatology, covering the full North America domain, and using some cool generative deep-learning models for filling in missing areas - A third timeseries dataset based on MSWX/MSWEP</p>
<div class="section level3">
<h3 id="breaking-changes-0-2-0">Breaking Changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-2-0"></a></h3>
<ul><li>We having improved the database connection algorithm, and have removed the <code>dbCon</code> parameter from all <code>input_*</code> functions. If you supply a database connection, it will give an error.</li>
<li>Previously, <code>climr</code> expected the bounding box vector to be in the reverse of the standard order. We have changed this so you can now directly supply a <code><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">terra::ext</a></code> object.</li>
<li>Since all base climatologies now cover the full NA domain, we have removed the <code>auto</code> option from <code>which_refmap</code>. The default is now <code>refmap_climr</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-2-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-0"></a></h3>
<ul><li>Fixed a bug that caused failure in downloads of gcm time series.</li>
<li>Fixed a bug in the CNRM-ESM2-1 future time series</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-2-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-2-0"></a></h3>
<ul><li>Added a new parameter <code>db_option</code> to downscale, with options <code>local</code>, <code>database</code>, or <code>auto</code> to specify where the downscaling should occur. Option <code>auto</code> attempts to choose the best option based on the number of points and type of query.</li>
<li>Added a new boolean parameter <code>ensemble_mean</code> to downscale, to optionally not return the ensemble mean of model runs.</li>
<li>Expanded the climr mosaic of 1981-2010 gridded climatologies to the full North American domain. Learn about it <a href="https://bcgov.github.io/climr/articles/methods_mosaic.html">here</a>.</li>
<li>Added a 1901-2024 gridded observational time series based on the multi-source weather (MSWX/MSWEP) dataset. Learn about it <a href="https://bcgov.github.io/climr/articles/guidance_timeSeries.html">here</a>
</li>
<li>New function <code><a href="../reference/legend_ramp.html">legend_ramp()</a></code> for simplified legend plotting on color ramp maps, including accommodation of logarithmic scaling.</li>
<li>New function <code><a href="../reference/logVars.html">logVars()</a></code> for logarithmic transformation of specified columns in any data.table.</li>
<li>Added a Known Issues section to the vignettes, including the <a href="https://bcgov.github.io/climr/articles/knownIssues_DiscrepanciesWithClimateNA.html">FFP, NFFD, and PAS discrepancies with ClimateNA</a> and a <a href="https://bcgov.github.io/climr/articles/knownIssues_customRefmap.html">workaround for using custom refmaps</a>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.1" id="climr-011">
<code>climr</code> 0.1.1<a class="anchor" aria-label="anchor" href="#climr-011"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-1-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-1-1"></a></h3>
<ul><li>Modified the Hargreaves method for calculation of monthly solar radiation to allow for calculation of Eref and CMD above the arctic circle in a way that matches ClimateNA results.</li>
<li>Fixed an edge case in the tiling that resulted in NA values in southern Mexico if full North American extent was queried.</li>
<li>Fixed bug in caching where cache would fail due to incorrect folder name in certain cases.</li>
<li>Fixed a bug in <code>plot_downscale()</code> that affected colors when <code>pal = "gcms"</code> and labels when <code>endlabel = "gcms"</code>
</li>
<li>Fixed a bug where climr didn’t download the correct run names for historic GCMs</li>
<li>Modified the equations for frost-free period so that they are confined to a range of 0-365.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-1-1">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-1-1"></a></h3>
<ul><li>Redesigned the database to substantially improve speed of downloading gcm ssp timeseries, especially for a small number of points.</li>
<li>Added <code>run_nm</code> parameter to <code>downscale</code> and <code>input_gcm_*</code> functions so users can specify desired run(s). Also added <code><a href="../reference/data-option-lists.html">list_runs_ssp()</a></code> and <code><a href="../reference/data-option-lists.html">list_runs_historic()</a></code>
</li>
</ul></div>
<div class="section level3">
<h3 id="known-issues-0-1-1">Known issues<a class="anchor" aria-label="anchor" href="#known-issues-0-1-1"></a></h3>
<ul><li>There are discrepancies between climr and ClimateNA in values of frost-free period (eFFP, bFFP, and FFP) and frost-free days (NFFD). For FFP see issue <a href="https://github.com/bcgov/climr/issues/297" class="external-link">#297</a>; For NFFD see issue <a href="https://github.com/bcgov/climr/issues/295" class="external-link">#295</a>. We will attempt to resolve these differences in a future version.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.0" id="climr-010">
<code>climr</code> 0.1.0<a class="anchor" aria-label="anchor" href="#climr-010"></a></h2>
<div class="section level3">
<h3 id="implementation-of-naming-conventions-0-1-0">Implementation of naming conventions<a class="anchor" aria-label="anchor" href="#implementation-of-naming-conventions-0-1-0"></a></h3>
<ul><li>We overhauled the naming of functions, parameters, and options to make them more intuitive and internally consistent. You will need to revise the climr code in your workflows to accommodate these changes. A table of correspondence specifying the changes is located at ./data-raw/namingChanges.csv and is viewable by calling <code>data(name_changes)</code>.</li>
<li>We changed the climate variable naming convention so that the climate element and the time of year are always separated by an underscore. e.g., Tmin01 becomes Tmin_01; DD_0_01 becomes DDsub0_01. The variables table called by <code>data(variables)</code> now has a field “Code_ClimateNA” with the variable codes used by ClimateBC/NA to allow users to crosswalk the two conventions.</li>
</ul></div>
<div class="section level3">
<h3 id="user-actions-required-0-1-0">User Actions Required<a class="anchor" aria-label="anchor" href="#user-actions-required-0-1-0"></a></h3>
<ul><li>To implement this new version, users must clear their cache of climate data by running the following line of code: cache_clear(). We will do our best to avoid the need for wholesale cache-clearing in the future.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-0-1-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-1-0"></a></h3>
<ul><li>Fixed an error in the calculation of Hogg’s climatic moisture index (CMI). This error was inherited from an unreported error in Equation 3 of Hogg (1997).<br></li>
<li>Fixed an error in the calculation of precipitation as snow. The PAS parameters in ClimateNA and <code>climr</code> differ from those originally published in Wang et al. (2016).</li>
<li>fixed an out-of-bounds error that affected user queries close to the coastline.</li>
<li>Added missing future 2015-2100 time series for the GFDL-ESM4 climate model.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-1-0">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-1-0"></a></h3>
<ul><li>Added <code><a href="../reference/plot_timeSeries.html">plot_timeSeries()</a></code> and <code><a href="../reference/plot_timeSeries_input.html">plot_timeSeries_input()</a></code> functions to generate plots of 20th and 21st century climate change for user-selected locations and climate variables.</li>
<li>Added a 1901-2022 observational time series of for the combined Climatic Research Unit TS dataset (for Temperature) and Global Precipitation Climatology Centre dataset (for precipitation).</li>
<li>Extended the ClimateNA observational time series to 1901-2023.</li>
<li>Added a vignette (article) providing guidance for climate model ensemble selection and emissions scenario selection.</li>
<li>Added a vignette (article) on the methods used to select the 13 global climate models provided by climr, and the 8-model ensemble recommended for most purposes.</li>
</ul></div>
<div class="section level3">
<h3 id="known-issues-0-1-0">Known issues<a class="anchor" aria-label="anchor" href="#known-issues-0-1-0"></a></h3>
<ul><li>Downloads of time series take a long time. We are looking into ways to speed this up, but until then we recommend users dedicate some time prior to analysis to cache their time series of interest for their areas of interest in a batch. Once the time series are cached, they don’t need to be downloaded again.</li>
<li>Related to the issue of time series download speed, the <code><a href="../reference/plot_timeSeries_input.html">plot_timeSeries_input()</a></code> function can take &gt;1hr to run for the first time it is called for a location.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.4" id="climr-004">
<code>climr</code> 0.0.4<a class="anchor" aria-label="anchor" href="#climr-004"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-0-4">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-0-4"></a></h3>
<ul><li>Updated future timeseries data to include full 2015-2100 period and added missing models (built some cool bash scrips using <code>parallel</code> to quickly to <code>raster2pgsql</code> conversion for large numbers of files).</li>
<li>Updated historic modelled timeseries to extend to December 31, 2014.</li>
<li>Restructured naming scheme for timeseries data, updated internal <code>dbnames</code> table, and updated <code>postgresql</code> functions to allow hyphens in table names.</li>
<li>Reprocessed future GCM periods to include all of North America.</li>
<li>Fixed bug in <code><a href="../reference/plot_bivariate.html">plot_bivariate()</a></code> for focal periods after 2001-2020.</li>
<li>Fixed caching issue where it would fail for very larger numbers of layers (&gt;65000) by saving as .gri binary files.</li>
</ul></div>
<div class="section level3">
<h3 id="enhancements-0-0-4">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-4"></a></h3>
<ul><li>Added checks for bounding box projection.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.3" id="climr-003">
<code>climr</code> 0.0.3<a class="anchor" aria-label="anchor" href="#climr-003"></a></h2>
<div class="section level3">
<h3 id="enhancements-0-0-3">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-3"></a></h3>
<ul><li>new tests comparing to reference outputs</li>
<li>code further streamlined</li>
<li>new messages warn user about meaningless <code>downscale</code>/<code>climr_downscale</code> argument combinations</li>
<li>argument options in <code>climr_downscale(..., which_normal)</code> now match the options of <code>normal_input(..., normal)</code>
</li>
<li>add <code><a href="../reference/plot_bivariate.html">plot_bivariate()</a></code> function to generate plots showing climate model ensemble variation in recent and future climate change.</li>
<li>new functions <code>list_historic_ts</code> and <code>list_gcm_ts</code> to get available years for historic/future time series</li>
</ul></div>
<div class="section level3">
<h3 id="behaviour-changes-0-0-3">Behaviour changes<a class="anchor" aria-label="anchor" href="#behaviour-changes-0-0-3"></a></h3>
<ul><li>
<code>xyz</code> (argument to <code>climr_downscale</code> and <code>downscale</code>) and <code>in_xyz</code> (argument to <code>get_bb</code>), must now be a 4 column <code>data.table</code> (or coercible class) with <code>lon</code>, <code>lat</code>, <code>elev</code> and <code>id</code> columns. All other columns are ignored and NOT returned. Column order no longer matters.</li>
</ul></div>
<div class="section level3">
<h3 id="bugfixes-0-0-3">Bugfixes<a class="anchor" aria-label="anchor" href="#bugfixes-0-0-3"></a></h3>
<ul><li>cache fixes</li>
<li>fixing geographical checks to get highest resolution beyond BC, Canada</li>
<li>fixing <code>historic_input_ts</code> to get only queried years</li>
<li>
<code>get_bb</code> follows column names</li>
</ul></div>
<div class="section level3">
<h3 id="other-0-0-3">Other<a class="anchor" aria-label="anchor" href="#other-0-0-3"></a></h3>
<ul><li>
<code>climr_downscale</code> now accepts <code>...</code> to pass arguments to <code>downscale</code>
</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.2" id="climr-002">
<code>climr</code> 0.0.2<a class="anchor" aria-label="anchor" href="#climr-002"></a></h2>
<div class="section level3">
<h3 id="bugfixes-0-0-2">Bugfixes<a class="anchor" aria-label="anchor" href="#bugfixes-0-0-2"></a></h3>
<ul><li>fixed temperature values of composite anomalies</li>
<li>name of composite anomalies changed to “normal_composite” in <code>normal_input(..., normal)</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-0-0-2">Documentation<a class="anchor" aria-label="anchor" href="#documentation-0-0-2"></a></h3>
<ul><li>added vignettes</li>
<li>
<code>pkgdown</code> website for <code>climr</code> is live</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.1" id="climr-001">
<code>climr</code> 0.0.1<a class="anchor" aria-label="anchor" href="#climr-001"></a></h2>
<div class="section level3">
<h3 id="enhancements-0-0-1">Enhancements<a class="anchor" aria-label="anchor" href="#enhancements-0-0-1"></a></h3>
<ul><li>continuous testing implemented via GitHub Actions</li>
<li>code was cleaned up following <code>tidyverse</code> syntax recommendations</li>
<li>internal function definitions are now avoided</li>
<li>improvements to function documentation</li>
<li>removal of deprecated functions</li>
<li>increased code coverage</li>
<li>some code streamlining</li>
<li>added new composite climatologies of Western Canada and Western US.</li>
</ul></div>
<div class="section level3">
<h3 id="bugfixes-0-0-1">Bugfixes<a class="anchor" aria-label="anchor" href="#bugfixes-0-0-1"></a></h3>
<ul><li>fixed examples</li>
<li>fixed incomplete changing of package name (<code>climRpnw</code> to <code>climr</code>)</li>
<li>added missing pkg imports</li>
<li>fixed caching problem where cached objects were not being retrieved when the PostGIS server was unavailable</li>
<li>fixed model names in PostGIS server, which fixed bugs in <code>gcm_hist_input</code> and <code>gcm_ts_input</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="dependency-changes-0-0-1">Dependency changes<a class="anchor" aria-label="anchor" href="#dependency-changes-0-0-1"></a></h3>
<ul><li>
<code>methods</code> removed from Imports</li>
<li>
<code>sf</code> added to Imports</li>
</ul></div>
<div class="section level3">
<h3 id="other-0-0-1">Other<a class="anchor" aria-label="anchor" href="#other-0-0-1"></a></h3>
<ul><li>old data base access functions removed</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9990" id="climr-0009990">
<code>climr</code> 0.0.0.9990<a class="anchor" aria-label="anchor" href="#climr-0009990"></a></h2>
<p>Beta-version</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kiri Daust, Colin Mahony, Bruno Tremblay, Ceres Barros, Province of British Columbia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

